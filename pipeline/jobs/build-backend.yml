steps:
  - task: DotNetCoreCLI@2
    inputs:
      command: restore
      projects: |
        **/*.csproj
      workingDirectory: $(workingDirectory)
    displayName: "Restore Dependencies"

  - task: DotNetCoreCLI@2
    inputs:
      command: build
      projects: |
        **/*.csproj
      workingDirectory: $(workingDirectory)
      arguments: "-c $(buildConfiguration)"
    displayName: "Build Projects"

  - task: DotNetCoreCLI@2
    inputs:
      command: test
      projects: |
        **/*Tests.csproj
      workingDirectory: $(workingDirectory)
      arguments: "-c $(buildConfiguration) /p:CollectCoverage=true /p:CoverletOutputFormat=cobertura"
    displayName: "Run Test"
